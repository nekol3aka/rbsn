<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Data Entry</title>
</head>
<body>
    <h2>แบบฟอร์มกรอกข้อมูลลูกค้า</h2>
    <form id="dataForm">
        <label for="customerName">รายชื่อลูกค้า:</label>
        <input type="text" id="customerName" name="customerName" required><br><br>

        <label for="product">รายการสินค้า:</label>
        <input type="text" id="product" name="product" required><br><br>

        <label for="quantity">จำนวน:</label>
        <input type="number" id="quantity" name="quantity" required><br><br>

        <label for="unit">หน่วย:</label>
        <input type="text" id="unit" name="unit" required><br><br>

        <button type="button" onclick="addData()">เพิ่มข้อมูล</button>
        <button type="button" onclick="exportToExcel()">บันทึกเป็น Excel</button>
    </form>

    <br>

    <h3>ข้อมูลที่กรอก</h3>
    <table border="1" id="dataTable">
        <thead>
            <tr>
                <th>รายชื่อลูกค้า</th>
                <th>รายการสินค้า</th>
                <th>จำนวน</th>
                <th>หน่วย</th>
            </tr>
        </thead>
        <tbody>
            <!-- ข้อมูลจะถูกเพิ่มที่นี่ -->
        </tbody>
    </table>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
    <script>
        let data = [];

        function addData() {
            // ดึงข้อมูลจากฟอร์ม
            const customerName = document.getElementById('customerName').value;
            const product = document.getElementById('product').value;
            const quantity = document.getElementById('quantity').value;
            const unit = document.getElementById('unit').value;

            // เพิ่มข้อมูลลงใน array
            data.push({ customerName, product, quantity, unit });

            // แสดงข้อมูลในตาราง
            const table = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();
            newRow.innerHTML = `<td>${customerName}</td><td>${product}</td><td>${quantity}</td><td>${unit}</td>`;
        }

        function exportToExcel() {
            // สร้าง worksheet และ workbook
            const ws = XLSX.utils.json_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Customers");

            // บันทึกเป็นไฟล์ Excel
            XLSX.writeFile(wb, "customer_data.xlsx");
        }
    </script>
</body>
</html>
